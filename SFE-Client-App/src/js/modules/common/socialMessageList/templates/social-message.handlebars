<div class="message-wrap">
    <div class="message-reshare">
        {{#if share}}
        <div class="reshare-icon"></div>
        <p class="reshare-wrap">
            <span class="shared-by">Shared by</span>
            <a class="shared-by-name profile-link person has-hover-profile colorable aliasable" data-userid="{{from.id}}" data-usertype="{{from.userType}}">{{from.prettyName}}</a>
            {{#if text}}
            <span class="reshare-text">{{parseMessageText text entities media}}</span>
            {{/if}}
            <time data-timestamp="{{ingestionDate}}" data-tooltip="{{timestamp ingestionDate  'MMMM Do, YYYY h:mm:ss a'}}" data-tooltip-position="left center">{{#if absoluteTime}}{{timestamp ingestionDate  'MMMM Do, YYYY' }}{{else}}{{fromNow ingestionDate}}{{/if}}</time>
        </p>
        {{/if}}
    </div>
    {{#if share}}
        {{wrappedAvatar share.message.from}}
    {{else}}
        {{wrappedAvatar from}}
    {{/if}}
    <div class="message-wrap-inner">
        <div class="message-text">
            <div class="message-meta">
                {{#if share}}
                <a href="#" class="identity profile-link person has-hover-profile colorable aliasable" data-userid="{{share.message.from.id}}" data-usertype="{{share.message.from.userType}}">{{share.message.from.prettyName}}</a>
                {{else}}
                <a href="#" class="identity profile-link person has-hover-profile colorable aliasable" data-userid="{{from.id}}" data-usertype="{{from.userType}}">{{from.prettyName}}</a>
                {{/if}}
                {{#if share}}
                <time data-timestamp="{{share.message.ingestionDate}}" data-tooltip="{{timestamp share.message.ingestionDate  'MMMM Do, YYYY h:mm:ss a'}}" data-tooltip-position="left center">{{#if absoluteTime}}{{timestamp share.message.ingestionDate  'MMMM Do, YYYY' }}{{else}}{{fromNow share.message.ingestionDate}}{{/if}}</time>
                {{else}}
                <time data-timestamp="{{ingestionDate}}" data-tooltip="{{timestamp ingestionDate  'MMMM Do, YYYY h:mm:ss a'}}" data-tooltip-position="left center">{{#if absoluteTime}}{{timestamp ingestionDate  'MMMM Do, YYYY' }}{{else}}{{fromNow ingestionDate}}{{/if}}</time>
                {{/if}}
            </div>
            {{#if share}}
                {{parseMessageText share.message.text share.message.entities share.message.media}}
                {{#if share.message.attachments}}
                    {{#each share.message.attachments}}
                        <span class="file-download">
                            <span class="download-arrow"></span>
                            <a href="{{../apiUrl}}/attachment/download?fileid={{fileId}}&messageid={{urlEncoded ../share.message.messageId}}" class="attachment{{ifPreviewContent name}}" download="{{name}}">{{name}} ({{friendlyFileSize sizeInBytes}})</a>
                        </span>
                    {{/each}}
                {{/if}}
            {{else}}
                {{parseMessageText text entities media}}
                {{#if attachments}}
                    {{#each attachments}}
                        <span class="file-download">
                            <span class="download-arrow"></span>
                            <a href="{{../apiUrl}}/attachment/download?fileid={{fileId}}&messageid={{urlEncoded ../messageId}}" class="attachment{{ifPreviewContent name}}" download="{{name}}">{{name}} ({{friendlyFileSize sizeInBytes}})</a>
                        </span>
                    {{/each}}
                {{/if}}
            {{/if}}
            <div class="message-actions-compact">
                {{#if isShareable}}
                <div class="social_action_btn share">
                    <div class="share-icon"></div>
                </div>
                {{/if}}

                {{#if shareCount}}
                <div class="social_action_btn shared_by">
                    <div class="share-count colum-{{shareCountWidth}}">{{shareCount}}</div>
                    <div class="share-icon"></div>
                </div>
                {{/if}}

                <!--Placeholder for like button and number of like-->

                {{#if hasContext}}
                <div class="social_action_btn context" data-streamid="{{localStream.threadId}}">
                    <div class="context-icon"></div>
                </div>
                {{/if}}

                {{#unless isInDeleteModal}}
                {{#if isDeletable}}
                <div class="delete social_action_btn">
                    <div class="delete-icon"></div>
                </div>
                {{/if}}
                {{/unless}}
                {{#if share}}
                <time data-timestamp="{{share.message.ingestionDate}}" data-tooltip="{{timestamp share.message.ingestionDate  'MMMM Do, YYYY h:mm:ss a'}}" data-tooltip-position="left center">{{#if absoluteTime}}{{timestamp share.message.ingestionDate  'MMMM Do, YYYY' }}{{else}}{{fromNow share.message.ingestionDate}}{{/if}}</time>
                {{else}}
                <time data-timestamp="{{ingestionDate}}" data-tooltip="{{timestamp ingestionDate  'MMMM Do, YYYY h:mm:ss a'}}" data-tooltip-position="left center">{{#if absoluteTime}}{{timestamp ingestionDate  'MMMM Do, YYYY' }}{{else}}{{fromNow ingestionDate}}{{/if}}</time>
                {{/if}}
            </div>
        </div>
        <div class="message-actions">
            {{#if isShareable}}
                <div class="social_action_btn share">
                    <div class="share-icon"></div>
                    <span>Share</span>
                </div>
            {{/if}}

            {{#if shareCount}}
            <div class="social_action_btn shared_by">
                <div class="share-count colum-{{shareCountWidth}}">{{shareCount}}</div>
                <div class="share-icon"></div>
                <div class="share-count-suffix">{{pluralizeShare shareCount}}</div>
            </div>
            {{/if}}
            <!--Placeholder for like button and number of like-->

            {{#if hasContext}}
                <div class="social_action_btn context" data-streamid="{{localStream.threadId}}">
                    <div class="context-icon"></div>
                    Context
                </div>
            {{/if}}

            {{#unless isInDeleteModal}}
                {{#if isDeletable}}
                    <div class="delete social_action_btn">
                        <div class="delete-icon"></div>
                        Delete
                    </div>
                {{/if}}
            {{/unless}}

        </div>
    </div>
    <hr>
</div>